const e="https://ajax.googleapis.com/ajax/libs/model-viewer/3.1.1/model-viewer.min.js",t=`${e}.map`;const n={"camera-controls":!0,"auto-rotate":!0,"shadow-intensity":1};function i(e){e.get("/viewer/:file_id",((e,t)=>{const i=(({title:e,options:t})=>`<html>\n<head>\n    <title>${e}</title>\n    <script type="module" src="/3d-viewer/model-viewer.min.js"><\/script>\n    <script type="module" src="/3d-viewer/live-preview.js"><\/script>\n    <style>body { margin: 0; padding: 0; } model-viewer { width: 100%; height: 100%; }</style>\n</head>\n<body>\n    <model-viewer ${Object.keys(t).filter((e=>!!t[e])).map((e=>!0===t[e]?e:`${e}="${t[e]}"`)).join("\n")}>\n    </model-viewer>\n</body>\n</html>`)({title:"TEST",options:function(e,t={}){const i={...n,...t,src:e};return Object.fromEntries(Object.entries(i).filter((([e,t])=>!!t)))}(`/assets/${e.params.file_id}`,{"camera-controls":"camera_controls"in e.query??!0,"auto-rotate":"auto_rotate"in e.query??!0,"shadow-intensity":e.query?.shadow_intensity??1,scale:e.query?.scale??"1 1 1"})});t.send(i)}))}const s=[{name:"3d-model-loader",config:function({embed:e}){e("head",'<script type="module" src="/3d-viewer/model-viewer.min.js"><\/script>')}}],o=[{name:"3d-model-api",config:{id:"3d-viewer",handler:n=>{!function(n){const i=fetch(e).then((e=>e.text())),s=fetch(t).then((e=>e.text()));n.get("/model-viewer.min.js",(async(e,t)=>{t.set("Content-Type","application/javascript"),t.send(await i)})),n.get("/model-viewer.min.js.map",(async(e,t)=>{t.set("Content-Type","application/json"),t.send(await s)}))}(n),function(e){e.get("/live-preview.js",((e,t)=>{t.set("Content-Type","application/javascript"),t.send("\n// use the current token for fetching the file\nconst elem = document.getElementsByTagName('model-viewer')[0];\nfetch('/auth/refresh', { method: 'POST', credentials: 'include' })\n    .then(res => res.json()).then(({ data: { access_token } }) => access_token)\n    .then(token => { \n        if(token){\n            elem.setAttribute('src', elem.getAttribute('src') + '?access_token=' + token);\n        } else {\n            elem.setAttribute('src', elem.getAttribute('src') );\n        }\n\n    })\n")}))}(n),i(n)}}}],r=[];export{o as endpoints,s as hooks,r as operations};
